(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{5668:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>d});var n=s(7876),l=s(4232),t=s(5364);let c={1:"김치찌개.jpg",2:"떡볶이.jpg",3:"스테이크.jpg",4:"초밥.jpg",5:"치킨.jpg"};function i(e){return"number"==typeof e.id&&c[e.id]?"/image/".concat(c[e.id]):"https://source.unsplash.com/featured/?".concat(encodeURIComponent(e.name))}function r(e){let{place:a,onClose:s}=e,[t,c]=(0,l.useState)(""),[i,r]=(0,l.useState)(2);if(!a)return null;async function d(){let e={datetime:t,partySize:i};"number"==typeof(null==a?void 0:a.id)?e.placeId=a.id:e.placeExternalId=String(null==a?void 0:a.id),e.place={name:null==a?void 0:a.name,address:null==a?void 0:a.address,lat:null==a?void 0:a.lat,lng:null==a?void 0:a.lng,phone:null==a?void 0:a.phone};let n=await fetch("/api/reservations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(n.ok)alert("예약이 성공했습니다"),s();else{let e=await n.json().catch(()=>({}));alert("예약 실패: ".concat(e.error||n.statusText))}}return(0,n.jsx)("div",{className:"modalBackdrop",children:(0,n.jsxs)("div",{className:"modal",children:[(0,n.jsxs)("h3",{children:["예약 — ",a.name]}),(0,n.jsxs)("div",{className:"muted",children:["주소: ",a.address]}),(0,n.jsxs)("div",{className:"formRow",children:[(0,n.jsx)("input",{value:t,onChange:e=>c(e.target.value),placeholder:"예: 2025-09-16T19:00"}),(0,n.jsxs)("select",{value:String(i),onChange:e=>r(parseInt(e.target.value,10)),children:[(0,n.jsx)("option",{value:"1",children:"1"}),(0,n.jsx)("option",{value:"2",children:"2"}),(0,n.jsx)("option",{value:"3",children:"3"}),(0,n.jsx)("option",{value:"4",children:"4"}),(0,n.jsx)("option",{value:"6",children:"6"})]})]}),(0,n.jsxs)("div",{className:"modalActions",children:[(0,n.jsx)("button",{className:"btn secondary",onClick:s,children:"취소"}),(0,n.jsx)("button",{className:"btn",onClick:d,style:{background:"var(--accent)",color:"#fff"},children:"예약하기"})]})]})})}function d(){let[e,a]=(0,l.useState)(""),[s,c]=(0,l.useState)([]),[d,o]=(0,l.useState)([]),u=(0,l.useRef)(null),m=(0,l.useRef)(!1),h=(0,l.useRef)([]),[p,v]=(0,l.useState)(null);function j(){if(!t.env.NEXT_PUBLIC_KAKAO_JS_KEY||!u.current)return;let e=window.kakao;e&&e.maps.load(()=>{let a=u.current,s={center:new e.maps.LatLng(37.5665,126.978),level:5},n=new e.maps.Map(a,s);n.kakao=e,navigator.geolocation&&navigator.geolocation.getCurrentPosition(a=>{let{latitude:s,longitude:l}=a.coords;n.setCenter(new e.maps.LatLng(s,l))})})}async function f(a){null==a||a.preventDefault();let s=await fetch("/api/places?q=".concat(encodeURIComponent(e)));c((await s.json()).results||[])}(0,l.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/places"),a=(await e.json()).results||[];o(a.slice(0,4)),c(a)}catch(e){console.error("Failed to load recommended",e)}})();let e=t.env.NEXT_PUBLIC_KAKAO_JS_KEY;if(e)if(document.getElementById("kakao-sdk"))m.current=!0,j();else{let a=document.createElement("script");a.id="kakao-sdk",a.src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=".concat(e,"&autoload=false&libraries=services"),a.async=!0,document.head.appendChild(a),a.onload=()=>{m.current=!0,j()}}},[]),(0,l.useEffect)(()=>{if(!t.env.NEXT_PUBLIC_KAKAO_JS_KEY)return;let e=window.kakao;if(!e)return;let a=u.current;if(!a)return;let n=e.maps.getMap(a);n&&(h.current.forEach(e=>e.setMap(null)),h.current=[],s.forEach(a=>{if(!a.lat||!a.lng)return;let s=new e.maps.Marker({position:new e.maps.LatLng(a.lat,a.lng)});s.setMap(n),h.current.push(s)}))},[s]);let x=Array.from(new Set(s.map(e=>e.category).filter(Boolean)));return(0,n.jsxs)("div",{className:"container",children:[(0,n.jsxs)("div",{className:"header",children:[(0,n.jsx)("div",{className:"brand",children:"예약앱"}),(0,n.jsxs)("div",{className:"searchRow",children:[(0,n.jsx)("form",{onSubmit:f,children:(0,n.jsx)("input",{className:"searchInput",placeholder:"음식/매장 검색 (예: 김치찌개)",value:e,onChange:e=>a(e.target.value)})}),(0,n.jsx)("button",{className:"searchBtn",onClick:e=>f(e),children:"검색"})]})]}),(0,n.jsxs)("div",{className:"layout",children:[(0,n.jsxs)("div",{className:"left",children:[(0,n.jsxs)("div",{className:"card",children:[(0,n.jsx)("div",{style:{fontWeight:700},children:"추천 식당"}),(0,n.jsx)("div",{style:{marginTop:10,display:"flex",gap:10,overflowX:"auto"},children:d.map(e=>(0,n.jsx)("div",{style:{minWidth:180},children:(0,n.jsxs)("a",{href:"/place/".concat(e.id),style:{textDecoration:"none",color:"inherit"},children:[(0,n.jsx)("img",{style:{width:"100%",height:110,objectFit:"cover",borderRadius:6},src:i(e),alt:e.name}),(0,n.jsx)("div",{style:{marginTop:6,fontWeight:600},children:e.name}),(0,n.jsx)("div",{className:"muted",children:e.category})]})},String(e.id)))})]}),(0,n.jsxs)("div",{className:"card",children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,n.jsx)("div",{style:{fontWeight:700},children:"검색 결과"}),(0,n.jsxs)("div",{className:"muted",children:[s.length,"곳"]})]}),(0,n.jsx)("div",{className:"chips",style:{marginTop:10},children:x.map(e=>(0,n.jsx)("div",{className:"chip",children:e},e))}),(0,n.jsx)("div",{style:{marginTop:12},className:"placeList",children:0===s.length?(0,n.jsx)("div",{className:"muted",children:"검색 결과가 없습니다. 검색어를 입력해보세요."}):s.map(e=>(0,n.jsxs)("div",{className:"placeRow",children:[(0,n.jsx)("img",{className:"placeImg",src:i(e),alt:e.name}),(0,n.jsxs)("div",{className:"placeInfo",children:[(0,n.jsx)("div",{className:"placeName",children:e.name}),(0,n.jsx)("div",{className:"muted",children:e.category}),(0,n.jsx)("div",{style:{marginTop:6},className:"muted",children:e.address}),(0,n.jsxs)("div",{className:"actions",children:[(0,n.jsx)("button",{className:"btn",onClick:()=>v(e),style:{background:"#111",color:"#fff"},children:"예약하기"}),(0,n.jsx)("a",{className:"btn secondary",href:"/place/".concat(e.id),children:"상세보기"})]})]})]},String(e.id)))})]})]}),(0,n.jsx)("div",{className:"right",children:(0,n.jsx)("div",{className:"card mapBox",ref:u,id:"map"})})]}),p&&(0,n.jsx)(r,{place:p,onClose:()=>v(null)})]})}},6760:(e,a,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(5668)}])}},e=>{e.O(0,[636,593,792],()=>e(e.s=6760)),_N_E=e.O()}]);