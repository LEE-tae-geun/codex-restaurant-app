(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{5668:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>l});var a=n(7876),r=n(4232),s=n(5364);function l(){let[e,t]=(0,r.useState)(""),[n,l]=(0,r.useState)([]),i=(0,r.useRef)(null),o=(0,r.useRef)(!1),d=(0,r.useRef)([]);function c(){if(!s.env.NEXT_PUBLIC_KAKAO_JS_KEY||!i.current)return;let e=window.kakao;e&&e.maps.load(()=>{let t=i.current,n={center:new e.maps.LatLng(37.5665,126.978),level:5},a=new e.maps.Map(t,n);a.kakao=e,navigator.geolocation&&navigator.geolocation.getCurrentPosition(t=>{let{latitude:n,longitude:r}=t.coords;a.setCenter(new e.maps.LatLng(n,r))})})}async function p(t){null==t||t.preventDefault();let n=await fetch("/api/places?q=".concat(encodeURIComponent(e)));l((await n.json()).results||[])}async function u(e){let t=prompt("예약 날짜/시간을 ISO 형식으로 입력하세요 (예: 2025-09-16T19:00)");if(!t)return;let n=prompt("인원 수를 입력하세요","2"),a={datetime:t,partySize:n?parseInt(n,10):2};"number"==typeof e.id?a.placeId=e.id:a.placeExternalId=String(e.id),a.place={name:e.name,address:e.address,lat:e.lat,lng:e.lng,phone:e.phone};let r=await fetch("/api/reservations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(r.ok)alert("예약이 생성되었습니다.");else{let e=await r.json();alert("예약 실패: ".concat(e.error||r.statusText))}}return(0,r.useEffect)(()=>{let e=s.env.NEXT_PUBLIC_KAKAO_JS_KEY;if(e)if(document.getElementById("kakao-sdk"))o.current=!0,c();else{let t=document.createElement("script");t.id="kakao-sdk",t.src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=".concat(e,"&autoload=false&libraries=services"),t.async=!0,document.head.appendChild(t),t.onload=()=>{o.current=!0,c()}}},[]),(0,r.useEffect)(()=>{if(!s.env.NEXT_PUBLIC_KAKAO_JS_KEY)return;let e=window.kakao;if(!e)return;let t=i.current;if(!t)return;let a=e.maps.getMap(t);a&&(d.current.forEach(e=>e.setMap(null)),d.current=[],n.forEach(t=>{if(!t.lat||!t.lng)return;let n=new e.maps.Marker({position:new e.maps.LatLng(t.lat,t.lng)});n.setMap(a),d.current.push(n)}))},[n]),(0,a.jsxs)("div",{style:{padding:24,fontFamily:"Arial, sans-serif"},children:[(0,a.jsx)("h1",{children:"주변 맛집 찾아 예약하기"}),(0,a.jsxs)("form",{onSubmit:p,style:{marginBottom:12},children:[(0,a.jsx)("input",{placeholder:"검색어 (예: 한식, 김밥)",value:e,onChange:e=>t(e.target.value),style:{padding:8,width:300}}),(0,a.jsx)("button",{style:{marginLeft:8,padding:"8px 12px"},onClick:p,children:"검색"})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:16},children:[(0,a.jsx)("div",{style:{flex:1},children:0===n.length?(0,a.jsx)("p",{children:"검색 결과가 없습니다. 검색어를 입력하고 검색하세요."}):(0,a.jsx)("ul",{children:n.map(e=>(0,a.jsxs)("li",{style:{marginBottom:12},children:[(0,a.jsx)("strong",{children:e.name})," ",(0,a.jsx)("span",{style:{color:"#666"},children:e.category}),(0,a.jsx)("div",{style:{color:"#333"},children:e.address}),(0,a.jsxs)("div",{style:{marginTop:6},children:[(0,a.jsx)("button",{onClick:()=>u(e),style:{marginRight:8},children:"예약하기"}),(0,a.jsx)("a",{href:"/place/".concat(e.id),children:"상세보기"})]})]},String(e.id)))})}),(0,a.jsx)("div",{style:{width:480,height:480,border:"1px solid #ddd"},ref:i,id:"map"})]})]})}},6760:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(5668)}])}},e=>{e.O(0,[636,593,792],()=>e(e.s=6760)),_N_E=e.O()}]);